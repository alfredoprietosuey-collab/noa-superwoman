<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>30 d√≠as to be a Super Woman</title>
  <style>
    :root{
      --bg:#0b0f19; --panel:#121a2a; --panel2:#0f1626;
      --border:#25314a; --muted:#a8b0c2; --text:#e7eaf0;
      --good:#2ea043; --bad:#f85149; --empty:#1b243a; --warn:#f0b429;
      --blue:#1f6feb;
    }
    *{ box-sizing:border-box; }
    body{ margin:0; background:radial-gradient(1200px 700px at 20% 0%, #182241 0%, var(--bg) 55%);
          color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif; }
    .wrap{ max-width:980px; margin:0 auto; padding:18px; }
    .top{
      display:flex; gap:12px; flex-wrap:wrap; align-items:flex-end; justify-content:space-between;
      margin-bottom:14px;
    }
    h1{ margin:0; font-size:20px; }
    .subtitle{ margin-top:6px; color:var(--muted); font-size:13px; }
    .card{ background:linear-gradient(180deg, var(--panel) 0%, var(--panel2) 100%);
           border:1px solid var(--border); border-radius:16px; padding:14px; }
    .grid{ display:grid; gap:12px; grid-template-columns: 1.2fr 1fr; }
    @media (max-width: 880px){ .grid{ grid-template-columns: 1fr; } }

    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .pill{
      border:1px solid var(--border); background:#0c1426; color:var(--muted);
      padding:6px 10px; border-radius:999px; font-size:12px;
    }

    button, input, textarea{
      font:inherit;
    }
    button{
      border:0; border-radius:12px; padding:10px 12px; cursor:pointer;
      background:var(--blue); color:#fff;
    }
    button.secondary{ background:#23304a; border:1px solid #33415f; color:var(--text); }
    button.danger{ background:#3b1b1b; border:1px solid #6a2a2a; }
    button.good{ background:#17381f; border:1px solid #265a31; }
    button.bad{ background:#3a1717; border:1px solid #6a2a2a; }
    button:active{ transform:translateY(1px); }

    label{ font-size:12px; color:var(--muted); display:block; margin-bottom:6px; }
    input, textarea{
      width:100%; padding:10px 10px; border-radius:12px;
      border:1px solid var(--border); background:#0c1426; color:var(--text);
    }
    textarea{ min-height:90px; resize:vertical; }

    .stats{ display:grid; gap:10px; grid-template-columns: repeat(4, 1fr); }
    @media (max-width: 880px){ .stats{ grid-template-columns: repeat(2, 1fr); } }
    .stat{
      border:1px solid var(--border); border-radius:14px; padding:10px;
      background:#0c1426;
    }
    .stat .k{ color:var(--muted); font-size:12px; }
    .stat .v{ margin-top:4px; font-size:16px; font-weight:700; }

    .progress{
      height:10px; border-radius:999px; background:#0c1426; border:1px solid var(--border);
      overflow:hidden;
    }
    .progress > div{ height:100%; background:linear-gradient(90deg, #2ea043, #1f6feb); width:0%; }

    .calendar{
      display:grid; grid-template-columns: repeat(10, 1fr);
      gap:6px; margin-top:10px;
    }
    @media (max-width: 560px){ .calendar{ grid-template-columns: repeat(6, 1fr); } }
    .day{
      aspect-ratio:1/1; border-radius:10px; border:1px solid var(--border);
      background:var(--empty); cursor:pointer;
      display:flex; align-items:center; justify-content:center;
      font-size:12px; color:rgba(231,234,240,.85);
      user-select:none;
    }
    .day.good{ background:rgba(46,160,67,.22); border-color:rgba(46,160,67,.45); }
    .day.bad{ background:rgba(248,81,73,.18); border-color:rgba(248,81,73,.35); }
    .day.empty{ background:var(--empty); }
    .day.selected{ outline:2px solid rgba(31,111,235,.7); outline-offset:2px; }

    .hint{ color:var(--muted); font-size:12px; margin-top:8px; }
    .tiny{ font-size:12px; color:var(--muted); }
    .split{ display:grid; gap:10px; grid-template-columns: 1fr 1fr; }
    @media (max-width: 560px){ .split{ grid-template-columns: 1fr; } }

    .ok{ color:#7ee787; }
    .no{ color:#ffb4b4; }
    .warn{ color:#ffd27d; }

    .footer-actions{ display:flex; gap:10px; flex-wrap:wrap; justify-content:space-between; align-items:center; margin-top:10px; }
    .file{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div>
        <h1>30 d√≠as to be a Super Woman üí™‚ú®</h1>
        <div class="subtitle">
          Reto: <b>30‚Ç¨ ‚Üí 49.365,14‚Ç¨</b> (28% diario, reinvirtiendo) ¬∑ Marca cada d√≠a si has hecho trading.
        </div>
      </div>
      <div class="row">
        <span class="pill" id="statusPill">Sin empezar</span>
        <button class="secondary" id="jumpTodayBtn">Ir a hoy</button>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <div class="row" style="justify-content:space-between;">
          <div class="row">
            <button id="startTodayBtn">Empezar reto hoy</button>
            <button class="secondary" id="setStartBtn">Elegir fecha</button>
          </div>
          <button class="danger" id="resetBtn" title="Borra todo el progreso (solo en este navegador)">Reset</button>
        </div>

        <div class="split" style="margin-top:10px;">
          <div>
            <label>Fecha de inicio</label>
            <input type="date" id="startDateInput" />
            <div class="hint">Tip: si empiezas hoy, pulsa ‚ÄúEmpezar reto hoy‚Äù.</div>
          </div>
          <div>
            <label>Objetivo del reto</label>
            <input type="text" id="goalInput" disabled />
            <div class="hint">Se calcula como 30 √ó 1,28^30 ‚âà 49.365,14‚Ç¨</div>
          </div>
        </div>

        <div class="stats" style="margin-top:12px;">
          <div class="stat">
            <div class="k">D√≠a</div>
            <div class="v" id="dayStat">‚Äî</div>
          </div>
          <div class="stat">
            <div class="k">Objetivo hoy</div>
            <div class="v" id="targetStat">‚Äî</div>
          </div>
          <div class="stat">
            <div class="k">Racha</div>
            <div class="v" id="streakStat">‚Äî</div>
          </div>
          <div class="stat">
            <div class="k">Completados</div>
            <div class="v" id="doneStat">‚Äî</div>
          </div>
        </div>

        <div style="margin-top:10px;">
          <div class="row" style="justify-content:space-between;">
            <div class="tiny" id="progressText">‚Äî</div>
            <div class="tiny" id="onTrackText">‚Äî</div>
          </div>
          <div class="progress" aria-label="Progreso del reto">
            <div id="progressBar"></div>
          </div>
        </div>

        <div class="calendar" id="calendar" aria-label="Calendario 30 d√≠as"></div>
        <div class="hint">Pulsa un d√≠a para editarlo. Verde = trading ‚úÖ ¬∑ Rojo = no ‚ùå ¬∑ Gris = sin marcar.</div>
      </div>

      <div class="card">
        <div class="row" style="justify-content:space-between; align-items:flex-start;">
          <div>
            <div style="font-weight:700; font-size:14px;">Registro del d√≠a</div>
            <div class="tiny" id="editTitle">Selecciona un d√≠a</div>
          </div>
          <button class="secondary" id="clearDayBtn" title="Dejar el d√≠a sin marcar">Limpiar d√≠a</button>
        </div>

        <div style="margin-top:10px;" class="row">
          <button class="good" id="tradeYesBtn">Hoy he hecho trading ‚úÖ</button>
          <button class="bad" id="tradeNoBtn">Hoy NO ‚ùå</button>
        </div>

        <div class="split" style="margin-top:10px;">
          <div>
            <label>Saldo real al final del d√≠a (opcional)</label>
            <input inputmode="decimal" placeholder="Ej: 42.50" id="balanceInput" />
            <div class="hint">Si lo rellenas, te digo si vas por encima / por debajo del objetivo.</div>
          </div>
          <div>
            <label>Notas (opcional)</label>
            <input placeholder="Ej: ‚ÄòBuen d√≠a, segu√≠ el plan‚Äô" id="noteInput" />
            <div class="hint">Corto y r√°pido. Lo importante es la constancia.</div>
          </div>
        </div>

        <div class="row" style="margin-top:10px; justify-content:space-between;">
          <button id="saveBtn">Guardar</button>
          <span class="tiny" id="saveMsg"></span>
        </div>

        <hr style="border:0; border-top:1px solid var(--border); margin:14px 0;">

        <div style="font-weight:700; font-size:14px;">Backup</div>
        <div class="footer-actions">
          <div class="row">
            <button class="secondary" id="exportBtn">Exportar JSON</button>
            <div class="file">
              <input type="file" id="importFile" accept="application/json" />
              <button class="secondary" id="importBtn">Importar</button>
            </div>
          </div>
        </div>

        <div class="hint">Todo se guarda en tu navegador (localStorage). Exporta si cambias de m√≥vil/PC.</div>
      </div>
    </div>
  </div>

<script>
(() => {
  const LS_KEY = "superwoman_trading_tracker_v1";
  const cfg = { startAmount: 30, rate: 0.28, totalDays: 30 };

  const ‚Ç¨ = (n) => new Intl.NumberFormat("es-ES", { style:"currency", currency:"EUR", maximumFractionDigits:2 }).format(n);
  const clamp = (n, a, b) => Math.max(a, Math.min(b, n));
  const todayISO = () => new Date().toISOString().slice(0,10);
  const midnight = (d) => new Date(d.getFullYear(), d.getMonth(), d.getDate());
  const daysBetween = (a, b) => Math.round((midnight(b) - midnight(a)) / (24*60*60*1000));

  const defaultState = () => ({
    startDate: null, // ISO yyyy-mm-dd
    selectedDay: 1,  // 1..30
    entries: Array.from({length: cfg.totalDays}, () => ({
      trade: null,    // true/false/null
      balance: null,  // number|null
      note: "",
      updatedAt: null
    }))
  });

  let state = load();

  // Elements
  const statusPill = document.getElementById("statusPill");
  const startTodayBtn = document.getElementById("startTodayBtn");
  const setStartBtn = document.getElementById("setStartBtn");
  const resetBtn = document.getElementById("resetBtn");
  const startDateInput = document.getElementById("startDateInput");
  const goalInput = document.getElementById("goalInput");
  const jumpTodayBtn = document.getElementById("jumpTodayBtn");

  const dayStat = document.getElementById("dayStat");
  const targetStat = document.getElementById("targetStat");
  const streakStat = document.getElementById("streakStat");
  const doneStat = document.getElementById("doneStat");
  const progressText = document.getElementById("progressText");
  const onTrackText = document.getElementById("onTrackText");
  const progressBar = document.getElementById("progressBar");

  const calendar = document.getElementById("calendar");
  const editTitle = document.getElementById("editTitle");
  const tradeYesBtn = document.getElementById("tradeYesBtn");
  const tradeNoBtn = document.getElementById("tradeNoBtn");
  const clearDayBtn = document.getElementById("clearDayBtn");
  const balanceInput = document.getElementById("balanceInput");
  const noteInput = document.getElementById("noteInput");
  const saveBtn = document.getElementById("saveBtn");
  const saveMsg = document.getElementById("saveMsg");

  const exportBtn = document.getElementById("exportBtn");
  const importBtn = document.getElementById("importBtn");
  const importFile = document.getElementById("importFile");

  // Init
  goalInput.value = ‚Ç¨(cfg.startAmount * Math.pow(1 + cfg.rate, cfg.totalDays));
  startDateInput.value = state.startDate || "";

  renderCalendar();
  renderAll();
  renderEditor();

  // Helpers
  function load(){
    try{
      const raw = localStorage.getItem(LS_KEY);
      if(!raw) return defaultState();
      const parsed = JSON.parse(raw);
      // minimal validation
      if(!parsed.entries || !Array.isArray(parsed.entries) || parsed.entries.length !== cfg.totalDays) return defaultState();
      return {
        startDate: parsed.startDate || null,
        selectedDay: clamp(parsed.selectedDay || 1, 1, cfg.totalDays),
        entries: parsed.entries.map((e) => ({
          trade: (e.trade === true ? true : (e.trade === false ? false : null)),
          balance: (typeof e.balance === "number" ? e.balance : null),
          note: (typeof e.note === "string" ? e.note : ""),
          updatedAt: e.updatedAt || null
        }))
      };
    }catch{
      return defaultState();
    }
  }
  function save(){
    localStorage.setItem(LS_KEY, JSON.stringify(state));
  }

  function targetForDay(dayNumber){ // dayNumber 1..30 -> after that day
    return cfg.startAmount * Math.pow(1 + cfg.rate, dayNumber);
  }

  function dayFromToday(){
    if(!state.startDate) return null;
    const start = new Date(state.startDate);
    const now = new Date();
    const idx = daysBetween(start, now); // 0 for same day
    return clamp(idx + 1, 1, cfg.totalDays);
  }

  function lastCompletedDay(){
    // last day that is marked yes/no
    for(let i = cfg.totalDays-1; i >= 0; i--){
      if(state.entries[i].trade !== null) return i+1;
    }
    return 0;
  }

  function calcStreaks(){
    let best = 0, cur = 0;
    for(let i=0;i<cfg.totalDays;i++){
      if(state.entries[i].trade === true){
        cur++;
        best = Math.max(best, cur);
      } else {
        cur = 0;
      }
    }
    // current streak = from last completed day backwards until break (true only)
    let current = 0;
    const last = lastCompletedDay();
    for(let i=last-1; i>=0; i--){
      if(state.entries[i].trade === true) current++;
      else break;
    }
    return { current, best };
  }

  function countDone(){
    return state.entries.filter(e => e.trade !== null).length;
  }

  function renderAll(){
    const todayDay = dayFromToday();
    const selected = state.selectedDay;

    // Status pill
    if(!state.startDate){
      statusPill.textContent = "Sin empezar";
      statusPill.style.borderColor = "var(--border)";
    } else {
      const last = lastCompletedDay();
      if(last >= cfg.totalDays){
        statusPill.textContent = "Reto completado üéâ";
        statusPill.style.borderColor = "rgba(46,160,67,.55)";
      } else if(todayDay){
        statusPill.textContent = `En marcha (hoy: d√≠a ${todayDay}/30)`;
        statusPill.style.borderColor = "rgba(31,111,235,.55)";
      } else {
        statusPill.textContent = "En marcha";
        statusPill.style.borderColor = "rgba(31,111,235,.55)";
      }
    }

    // Stats
    dayStat.textContent = `${selected}/30`;
    targetStat.textContent = ‚Ç¨(targetForDay(selected));

    const { current, best } = calcStreaks();
    streakStat.textContent = `${current} (mejor ${best})`;

    const done = countDone();
    doneStat.textContent = `${done}/30`;

    const pct = Math.round((done / cfg.totalDays) * 100);
    progressText.textContent = `Progreso: ${pct}%`;
    progressBar.style.width = `${pct}%`;

    // On track text (based on selected day's balance if present)
    const e = state.entries[selected-1];
    if(e.balance !== null){
      const diff = e.balance - targetForDay(selected);
      const label = diff >= 0 ? `Vas por encima: +${‚Ç¨(diff)}` : `Vas por debajo: ${‚Ç¨(diff)}`;
      onTrackText.textContent = label;
      onTrackText.className = "tiny " + (diff >= 0 ? "ok" : "no");
    } else {
      onTrackText.textContent = "Saldo real: (opcional) para comparar";
      onTrackText.className = "tiny";
    }

    // Start date input
    startDateInput.value = state.startDate || "";

    // Calendar paints
    paintCalendar();

    // Editor
    renderEditor();
  }

  function renderCalendar(){
    calendar.innerHTML = "";
    for(let d=1; d<=cfg.totalDays; d++){
      const div = document.createElement("div");
      div.className = "day empty";
      div.textContent = d;
      div.dataset.day = String(d);
      div.title = `D√≠a ${d}`;
      div.addEventListener("click", () => {
        state.selectedDay = d;
        save();
        renderAll();
      });
      calendar.appendChild(div);
    }
  }

  function paintCalendar(){
    const nodes = calendar.querySelectorAll(".day");
    nodes.forEach(node => {
      const d = Number(node.dataset.day);
      const e = state.entries[d-1];
      node.classList.remove("good","bad","empty","selected");
      if(e.trade === true) node.classList.add("good");
      else if(e.trade === false) node.classList.add("bad");
      else node.classList.add("empty");

      if(d === state.selectedDay) node.classList.add("selected");
    });
  }

  function renderEditor(){
    const d = state.selectedDay;
    const e = state.entries[d-1];
    editTitle.textContent = `Editando d√≠a ${d} ¬∑ Objetivo: ${‚Ç¨(targetForDay(d))}`;

    balanceInput.value = (e.balance === null ? "" : String(e.balance));
    noteInput.value = e.note || "";

    // quick visual feedback on buttons
    tradeYesBtn.style.opacity = (e.trade === true ? "1" : ".85");
    tradeNoBtn.style.opacity = (e.trade === false ? "1" : ".85");
  }

  function setTrade(val){
    const e = state.entries[state.selectedDay-1];
    e.trade = val;
    e.updatedAt = new Date().toISOString();
    save();
    flash("Guardado ‚úÖ");
    renderAll();
  }

  function clearDay(){
    state.entries[state.selectedDay-1] = { trade:null, balance:null, note:"", updatedAt:null };
    save();
    flash("D√≠a limpiado");
    renderAll();
  }

  function flash(text){
    saveMsg.textContent = text;
    setTimeout(() => saveMsg.textContent = "", 1200);
  }

  // Actions
  startTodayBtn.addEventListener("click", () => {
    state.startDate = todayISO();
    state.selectedDay = 1;
    save();
    renderAll();
    flash("Reto iniciado hoy üöÄ");
  });

  setStartBtn.addEventListener("click", () => {
    const v = startDateInput.value;
    if(!v){ flash("Elige una fecha primero"); return; }
    state.startDate = v;
    save();
    renderAll();
    flash("Fecha guardada");
  });

  resetBtn.addEventListener("click", () => {
    const ok = confirm("¬øSeguro? Esto borra TODO el progreso en este navegador.");
    if(!ok) return;
    state = defaultState();
    save();
    renderAll();
    flash("Reset hecho");
  });

  jumpTodayBtn.addEventListener("click", () => {
    const d = dayFromToday();
    if(!d){ flash("Primero inicia el reto"); return; }
    state.selectedDay = d;
    save();
    renderAll();
    flash("Est√°s en hoy");
  });

  tradeYesBtn.addEventListener("click", () => setTrade(true));
  tradeNoBtn.addEventListener("click", () => setTrade(false));
  clearDayBtn.addEventListener("click", clearDay);

  saveBtn.addEventListener("click", () => {
    const e = state.entries[state.selectedDay-1];
    const raw = balanceInput.value.trim().replace(",", ".");
    if(raw === ""){
      e.balance = null;
    } else {
      const num = Number(raw);
      if(!Number.isFinite(num) || num < 0){
        flash("Saldo no v√°lido");
        return;
      }
      e.balance = num;
    }
    e.note = noteInput.value.trim();
    e.updatedAt = new Date().toISOString();
    save();
    flash("Guardado ‚úÖ");
    renderAll();
  });

  // Export / Import
  exportBtn.addEventListener("click", () => {
    const blob = new Blob([JSON.stringify(state, null, 2)], {type:"application/json"});
    const a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "superwoman-trading-tracker-backup.json";
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(() => URL.revokeObjectURL(a.href), 500);
  });

  importBtn.addEventListener("click", async () => {
    const file = importFile.files && importFile.files[0];
    if(!file){ flash("Elige un archivo JSON"); return; }
    try{
      const txt = await file.text();
      const parsed = JSON.parse(txt);
      if(!parsed.entries || !Array.isArray(parsed.entries) || parsed.entries.length !== cfg.totalDays){
        flash("JSON no v√°lido");
        return;
      }
      state = {
        startDate: parsed.startDate || null,
        selectedDay: clamp(parsed.selectedDay || 1, 1, cfg.totalDays),
        entries: parsed.entries.map((e) => ({
          trade: (e.trade === true ? true : (e.trade === false ? false : null)),
          balance: (typeof e.balance === "number" ? e.balance : null),
          note: (typeof e.note === "string" ? e.note : ""),
          updatedAt: e.updatedAt || null
        }))
      };
      save();
      renderAll();
      flash("Importado ‚úÖ");
    } catch {
      flash("No pude leer ese JSON");
    }
  });

})();
</script>
</body>
</html>
